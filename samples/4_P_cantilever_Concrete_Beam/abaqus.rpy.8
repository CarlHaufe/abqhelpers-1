# -*- coding: mbcs -*-
#
# Abaqus/CAE Release 2023 replay file
# Internal Version: 2022_09_28-20.11.55 183150
# Run by ac134018 on Mon Feb 27 17:37:02 2023
#

# from driverUtils import executeOnCaeGraphicsStartup
# executeOnCaeGraphicsStartup()
#: Executing "onCaeGraphicsStartup()" in the site directory ...
from abaqus import *
from abaqusConstants import *
session.Viewport(name='Viewport: 1', origin=(0.0, 0.0), width=176.490097045898, 
    height=155.674072265625)
session.viewports['Viewport: 1'].makeCurrent()
session.viewports['Viewport: 1'].maximize()
from caeModules import *
from driverUtils import executeOnCaeStartup
executeOnCaeStartup()
session.viewports['Viewport: 1'].partDisplay.geometryOptions.setValues(
    referenceRepresentation=ON)
execfile('4_P_cantilever_Concrete_Beam.py', __main__.__dict__)
#: C:/temp\GitHub_ch/abqhelpers/helpers/filemanager.py:10: RuntimeWarning: Parent module 'helpers' not found while handling absolute import
#:   import os
#: C:/temp\GitHub_ch/abqhelpers/helpers/filemanager.py:11: RuntimeWarning: Parent module 'helpers' not found while handling absolute import
#:   import sys
#: C:/temp\GitHub_ch/abqhelpers/helpers/filemanager.py:12: RuntimeWarning: Parent module 'helpers' not found while handling absolute import
#:   import shutil
#: C:/temp\GitHub_ch/abqhelpers/src/abq_parts.py:17: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqus import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_parts.py:18: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqusConstants import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_parts.py:19: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   import os
#: C:/temp\GitHub_ch/abqhelpers/src/abq_property.py:17: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqus import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_property.py:18: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqusConstants import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_property.py:19: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from driverUtils import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_property.py:20: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from caeModules import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_property.py:22: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   import os
#: C:/temp\GitHub_ch/abqhelpers/src/abq_property.py:23: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   import pickle
#: C:/temp\GitHub_ch/abqhelpers/src/abq_property.py:24: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   import numpy as np
#: C:/temp\GitHub_ch/abqhelpers/src/abq_assembly.py:17: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqus import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_assembly.py:18: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqusConstants import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_assembly.py:19: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   import os
#: C:/temp\GitHub_ch/abqhelpers/src/abq_interaction.py:17: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqus import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_interaction.py:18: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqusConstants import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_interaction.py:19: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   import os
#: C:/temp\GitHub_ch/abqhelpers/src/abq_interaction.py:20: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   import pickle
#: C:/temp\GitHub_ch/abqhelpers/src/abq_interaction.py:21: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   import numpy as np
#: C:/temp\GitHub_ch/abqhelpers/src/abq_step.py:17: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqus import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_step.py:18: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqusConstants import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_mesh.py:17: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqus import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_mesh.py:18: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqusConstants import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_mesh.py:19: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   import os
#: C:/temp\GitHub_ch/abqhelpers/src/abq_job.py:17: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqus import *
#: C:/temp\GitHub_ch/abqhelpers/src/abq_job.py:18: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from abaqusConstants import *
#: The model "Concrete_beam_4_cantilever_B" has been created.
#: C:/temp\GitHub_ch/abqhelpers/helpers/filemanager.py:80: RuntimeWarning: Parent module 'helpers' not found while handling absolute import
#:   import os
#: C:/temp\GitHub_ch/abqhelpers/src/abq_property.py:46: RuntimeWarning: Parent module 'sec' not found while handling absolute import
#:   from material import createMaterialFromDataString
#: Material 'concrete_cdp_C50_60' has been copied to the current model.
#: Material 'support_stiff' has been copied to the current model.
#: Material 'reinforcement_b500' has been copied to the current model.
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
p = mdb.models['Concrete_beam_4_cantilever_B'].parts['concrete-dummy-plates']
session.viewports['Viewport: 1'].setValues(displayedObject=p)
a = mdb.models['Concrete_beam_4_cantilever_B'].rootAssembly
session.viewports['Viewport: 1'].setValues(displayedObject=a)
session.viewports['Viewport: 1'].assemblyDisplay.setValues(
    optimizationTasks=OFF, geometricRestrictions=OFF, stopConditions=OFF)
session.viewports['Viewport: 1'].assemblyDisplay.setValues(mesh=ON)
session.viewports['Viewport: 1'].assemblyDisplay.meshOptions.setValues(
    meshTechnique=ON)
session.viewports['Viewport: 1'].view.setValues(session.views['Bottom'])
session.viewports['Viewport: 1'].view.setProjection(projection=PARALLEL)
a = mdb.models['Concrete_beam_4_cantilever_B'].rootAssembly
partInstances =(a.instances['concrete-dummy-plates-1'], )
a.deleteMesh(regions=partInstances)
mdb.saveAs(
    pathName='C:/temp/GitHub_ch/abqhelpers/samples/4_P_cantilever_Concrete_Beam/abaqu.cae')
#: The model database has been saved to "C:\temp\GitHub_ch\abqhelpers\samples\4_P_cantilever_Concrete_Beam\abaqu.cae".
mdb.save()
#: The model database has been saved to "C:\temp\GitHub_ch\abqhelpers\samples\4_P_cantilever_Concrete_Beam\abaqu.cae".
cliCommand("""def delete_mesh_all_active_instances(model,):
    a = model.rootAssembly
    for key in a.instances.keys():
    # choose only active instances
        if a.instances[key].ips != None:
            deleteMesh(regions=(a.instances['concrete-dummy-plates-1'],))
""")
cliCommand("""delete_mesh_all_active_instances(model,)""")
#* NameError: global name 'deleteMesh' is not defined
cliCommand("""abq_mesh.mesh.delete_mesh_all_active_instances(model,)""")
#* AttributeError: 'module' object has no attribute 'mesh'
cliCommand("""abq_mesh.mesh.delete_mesh_all_active_instances(model)""")
#* AttributeError: 'module' object has no attribute 'mesh'
cliCommand("""abq_mesh.generate_mesh_all_active_instances(model)""")
cliCommand("""abq_mesh.mesh.delete_mesh_all_active_instances(model)""")
#* AttributeError: 'module' object has no attribute 'mesh'
cliCommand("""def delete_mesh_all_active_instances(model,):
    a = model.rootAssembly
    for key in a.instances.keys():
    # choose only active instances
        if a.instances[key].ips != None:
            deleteMesh(regions=(a.instances['concrete-dummy-plates-1'],))
""")
cliCommand("""abq_mesh.mesh.delete_mesh_all_active_instances(model)""")
#* AttributeError: 'module' object has no attribute 'mesh'
cliCommand("""abq_mesh.delete_mesh_all_active_instances(model)""")
#* AttributeError: 'module' object has no attribute 
#* 'delete_mesh_all_active_instances'
cliCommand("""def delete_mesh_all_active_instances(model,):
    a = model.rootAssembly
    for key in a.instances.keys():
    # choose only active instances
        if a.instances[key].ips != None:
            deleteMesh(regions=(a.instances['concrete-dummy-plates-1'],))
""")
cliCommand("""abq_mesh.delete_mesh_all_active_instances(model)""")
#* AttributeError: 'module' object has no attribute 
#* 'delete_mesh_all_active_instances'
cliCommand("""def delete_mesh_all_active_instances(model,):
    a = model.rootAssembly
    for key in a.instances.keys():
    # choose only active instances
        if a.instances[key].ips != None:
            deleteMesh(regions=(a.instances[key],))
""")
cliCommand("""abq_mesh.delete_mesh_all_active_instances(model)""")
#* AttributeError: 'module' object has no attribute 
#* 'delete_mesh_all_active_instances'
cliCommand("""# -*- coding: utf-8 -*-""")
cliCommand("""# ------------------------------------------------------------------------------""")
cliCommand("""# Description:  Four Point Bending Test on Single Span Concrete Beam""")
cliCommand("""# Author:       carl.haufe@ilek.uni-stuttgart.de""")
cliCommand("""# Created:      27.02.2023""")
cliCommand("""# Execution:    Set work-dir to this file & run script in ABAQUS CAE""")
cliCommand("""# Status:       In Progress""")
cliCommand("""# ------------------------------------------------------------------------------""")
cliCommand("""# EXECUTION:""")
cliCommand("""# 1. Open CMD in your working directory""")
cliCommand("""# 2. Run script in ABAQUS CAE""")
cliCommand("""# abaqus cae script=4_P_cantilever_Concrete_Beam.py""")
cliCommand("""#""")
cliCommand("""# TAIL LOGS:""")
cliCommand("""# 1. Open CMD in your working directory""")
cliCommand("""# 2. Use powershell to tail logs""")
cliCommand("""# powershell Get-Content -Path Concrete_beam_4_P_B.dat -WAIT""")
cliCommand("""# powershell Get-Content -Path Concrete_beam_4_P_B.msg -WAIT""")
cliCommand("""# ------------------------------------------------------------------------------""")
cliCommand("""# Libraries""")
cliCommand("""# ------------------------------------------------------------------------------""")
cliCommand("""from abaqus import *""")
cliCommand("""from abaqusConstants import *""")
cliCommand("""from driverUtils import *""")
cliCommand("""from caeModules import *""")
cliCommand("""# ------------------------------------------------------------------------------""")
cliCommand("""# Install""")
cliCommand("""# ------------------------------------------------------------------------------""")
cliCommand("""# import custom libraries""")
cliCommand("""import os""")
cliCommand("""import imp""")
cliCommand("""import re""")
cliCommand("""import numpy as np""")
cliCommand("""# Requires full path to abqhelpers""")
cliCommand("""abq_path = 'C:/temp\\GitHub_ch/abqhelpers/'""")
cliCommand("""# Requires full path to abqhelpers - Material Library""")
cliCommand("""abq_mat_lib = os.path.join(abq_path, 'abaqus_plugins/MatLibrary.lib')""")
cliCommand("""try:
    # in Python: add via relative import for type hints
    from abqhelpers.helpers import filemanager
except:
    # in Abaqus: add via imp for correct import
    filemanager = imp.load_source(
        'helpers.filemanager', os.path.join(abq_path, 'helpers/filemanager.py'))
""")
cliCommand("""try:
    # in Python: add via relative import for type hints
    from abqhelpers.src import abq_parts
except:
    # in Abaqus: add via imp for correct import
    abq_parts = imp.load_source(
        'sec.abq_parts', os.path.join(abq_path, 'src/abq_parts.py'))
""")
cliCommand("""try:
    # in Python: add via relative import for type hints
    from abqhelpers.src import abq_property
except:
    # in Abaqus: add via imp for correct import
    abq_property = imp.load_source(
        'sec.abq_property', os.path.join(abq_path, 'src/abq_property.py'))
""")
cliCommand("""try:
    # in Python: add via relative import for type hints
    from abqhelpers.src import abq_assembly
except:
    # in Abaqus: add via imp for correct import
    abq_assembly = imp.load_source(
        'sec.abq_assembly', os.path.join(abq_path, 'src/abq_assembly.py'))
""")
cliCommand("""try:
    # in Python: add via relative import for type hints
    from abqhelpers.src import abq_interaction
except:
    # in Abaqus: add via imp for correct import
    abq_interaction = imp.load_source(
        'sec.abq_interaction', os.path.join(abq_path, 'src/abq_interaction.py'))
""")
cliCommand("""try:
    # in Python: add via relative import for type hints
    from abqhelpers.src import abq_step
except:
    # in Abaqus: add via imp for correct import
    abq_step = imp.load_source(
        'sec.abq_step', os.path.join(abq_path, 'src/abq_step.py'))
""")
cliCommand("""try:
    # in Python: add via relative import for type hints
    from abqhelpers.src import abq_mesh
except:
    # in Abaqus: add via imp for correct import
    abq_mesh = imp.load_source(
        'sec.abq_mesh', os.path.join(abq_path, 'src/abq_mesh.py'))
""")
cliCommand("""try:
    # in Python: add via relative import for type hints
    from abqhelpers.src import abq_job
except:
    # in Abaqus: add via imp for correct import
    abq_job = imp.load_source(
        'sec.abq_job', os.path.join(abq_path, 'src/abq_job.py'))
""")
cliCommand("""# ------------------------------------------------------------------------------""")
cliCommand("""# Functions""")
cliCommand("""# ------------------------------------------------------------------------------""")
cliCommand("""# Model""")
cliCommand("""# ----------------""")
cliCommand("""modelName = 'Concrete_beam_4_cantilever_B'""")
cliCommand("""# Delete to restart model""")
cliCommand("""try:
    del mdb.models[modelName]
except:
    pass
""")
cliCommand("""# Create model""")
cliCommand("""model = mdb.Model(name=modelName)""")
#: The model "Concrete_beam_4_cantilever_B" has been created.
cliCommand("""# Clean up""")
cliCommand("""try:
    del mdb.models['Model-1']
except:
    pass
""")
cliCommand("""# Part""")
cliCommand("""# ----------------""")
cliCommand("""dir_path = os.getcwd()""")
cliCommand("""parts_path = os.path.join(dir_path, 'geometry', 'parts')""")
cliCommand("""concrete_beam = abq_parts.import_3_d_parts(model, os.path.join(
    parts_path, 'concrete_beam.sat'))""")
cliCommand("""load_plates = abq_parts.import_3_d_parts(model, os.path.join(
    parts_path, 'load_plate.sat'), bodyNum=2, combine=False, mergeSolidRegions=False)""")
cliCommand("""load_traverse = abq_parts.import_3_d_parts(model, os.path.join(
    parts_path, 'load_traverse.sat'))""")
cliCommand("""support_plates = abq_parts.import_3_d_parts(model, os.path.join(
    parts_path, 'support_plate.sat'), bodyNum=2, combine=False, mergeSolidRegions=False)""")
cliCommand("""reinforcement = abq_parts.import_3_d_parts(model, os.path.join(
    parts_path, 'reinforcement.sat'))""")
cliCommand("""# Create reference points""")
cliCommand("""# ----------------""")
cliCommand("""filenames, filepaths = filemanager.scanSubdirsForFilesWithExtension(
    dir_path, '.rp')""")
cliCommand("""# structure of list:""")
cliCommand("""# referencePoint[0] = referencePoint""")
cliCommand("""# referencePoint[1] = types""")
cliCommand("""referencePoints = []""")
cliCommand("""for i, filepath in enumerate(filepaths):
    with open(filepath) as f:
        for j, l in enumerate(f):
            # clean up line
            l = re.sub(r'[\\n\\t\\s]*', '', l)
            l = l.split(',')
            # read coordinates from file
            (x, y, z) = [float(x) for x in l[0:3]]
            # read types from file
            types = l[3:]
            # Create reference point
            referencePoints.append([abq_parts.create_reference_point(
                x, y, z, model, filenames[i].replace('.rp', '')), types])
""")
cliCommand("""# Create Sets""")
cliCommand("""# ----------------""")
cliCommand("""# Create Sets - solids""")
cliCommand("""for ele in concrete_beam:
    abq_parts.create_Set_All_Cells(model, ele, ele)
for ele in load_plates:""")
#*     for ele in load_plates:
#*       ^
#* SyntaxError: invalid syntax
execfile(
    'C:/temp/GitHub_ch/abqhelpers/samples/4_P_cantilever_Concrete_Beam/4_P_cantilever_Concrete_Beam.py', 
    __main__.__dict__)
#: The model "Concrete_beam_4_cantilever_B" has been created.
#: Material 'concrete_cdp_C50_60' has been copied to the current model.
#: Material 'support_stiff' has been copied to the current model.
#: Material 'reinforcement_b500' has been copied to the current model.
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#: Partitioning failed for instance: concrete-dummy-plates-1
#* Error: Free Hex meshing is not supported.
#* File 
#* "C:/temp/GitHub_ch/abqhelpers/samples/4_P_cantilever_Concrete_Beam/4_P_cantilever_Concrete_Beam.py", 
#* line 323, in <module>
#*     model, elemTypes, elemShape=HEX, technique=FREE)
#* File "C:/temp\GitHub_ch/abqhelpers/src/abq_mesh.py", line 56, in 
#* assign_mesh_control_all_active_instances
#*     regions=c, elemShape=elemShape, technique=technique)
